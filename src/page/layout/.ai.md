# Page Layout Components Reference

## Location
- **Correct**: `/src/page/layout`
- Used by: App Router layouts in `/src/app`

## Structure

```
src/page/layout/
├── root-layout/          # Root layout (server + client)
│   ├── index.tsx         # Server component (fetches user session)
│   └── client.tsx        # Client component (StateProvider + UserInit)
│
└── app-layout/           # Main app layout (UI)
    └── index.tsx         # Header, nav, footer, etc.
```

## Root Layout (`root-layout/`)

**Purpose**: Global layout for ALL pages. Handles server-side data fetching and client-side state initialization.

### Server Component (`index.tsx`)
```typescript
export async function RootLayout({ children }) {
  // Fetch server-side data (e.g., user session)
  const user = await getUserSession()

  return <RootLayoutClient user={user}>{children}</RootLayoutClient>
}
```

### Client Component (`client.tsx`)
```typescript
'use client'

export function RootLayoutClient({ user, children }) {
  return (
    <StateProvider>
      <UserInit user={user} />
      {children}
    </StateProvider>
  )
}
```

**Key responsibilities:**
- Fetch user session from server
- Initialize global state (StateProvider)
- Hydrate user state from server data (UserInit)

## App Layout (`app-layout/`)

**Purpose**: Main application UI layout for pages in the `(app)` route group.

```typescript
'use client'

export function AppLayout({ children }) {
  return (
    <div>
      <Header />
      <main>{children}</main>
      <Footer />
    </div>
  )
}
```

**Add here:**
- Header/Navigation
- Sidebar
- Footer
- Any common UI elements for main app pages

**Used by**: `src/app/(app)/layout.tsx`

## How They Work Together

```
src/app/layout.tsx (Next.js root layout)
  ↓ imports RootLayout
src/page/layout/root-layout/index.tsx (server component)
  ↓ fetches user session
  ↓ passes to RootLayoutClient
src/page/layout/root-layout/client.tsx (client component)
  ↓ wraps with StateProvider
  ↓ initializes user state with UserInit
  ↓ renders children
    ↓
  src/app/(app)/layout.tsx (route group layout)
    ↓ imports AppLayout
  src/page/layout/app-layout/index.tsx
    ↓ renders header, nav, footer
    ↓ renders page content
```

## Creating Additional Layouts

You can create more layouts for different route groups:

**Admin Layout** (`admin-layout/`):
```typescript
// src/page/layout/admin-layout/index.tsx
export function AdminLayout({ children }) {
  return (
    <div>
      <AdminHeader />
      <AdminSidebar />
      <main>{children}</main>
    </div>
  )
}

// Used in: src/app/admin/layout.tsx
```

**Full-Page Layout** (no header/footer):
```typescript
// src/page/layout/full-page-layout/index.tsx
export function FullPageLayout({ children }) {
  return <div className="min-h-screen">{children}</div>
}

// Used in: src/app/(detail)/layout.tsx or specific pages
```

## Rules

1. **ALWAYS read this file before working in `/src/page/layout`**
2. **Root layout**: Server component → fetches data → passes to client component
3. **App layout**: Client component → UI only (header, nav, footer)
4. **Never duplicate StateProvider** - it's only in root-layout/client.tsx
5. **User initialization** happens in root-layout, not in app-layout
6. **Keep layouts focused**: Root = data/state, App = UI
