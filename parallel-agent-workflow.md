# 병렬 서브에이전트 워크플로우 가이드

대규모 기능 개발 시 서브에이전트를 병렬로 실행하여 개발 속도를 극대화하는 워크플로우입니다.

## 핵심 원리: 컨텍스트 격리

> **각 서브에이전트는 자기 역할의 `.ai.md`만 읽고 작업한다.**

- 전체 코드베이스를 알 필요 없음
- 자기 레이어의 `.ai.md` + 전달받은 타입 정보만으로 충분
- 컨텍스트가 적을수록 집중력이 높아지고 퀄리티가 올라감

## 워크플로우 개요

```
[요구사항 파악] → [플랜 수립] → [서브에이전트 병렬 실행]
```

### Step 1: 요구사항 파악

마스터 에이전트가 요구사항을 분석하고, 필요한 API와 데이터 구조를 파악합니다.

- 어떤 엔드포인트가 필요한지
- 어떤 데이터 타입이 오가는지
- 어떤 상태 관리가 필요한지

### Step 2: 플랜 수립

레이어별로 작업을 나누고, 트리거 조건을 정합니다.

```
api (타입) ─완성→ state 에이전트 시작
                 mock 에이전트 시작
                 api 에이전트는 실제 구현 계속

state (타입) ─완성→ page 에이전트 시작
                   state 에이전트는 실제 구현 계속
```

### Step 3: 서브에이전트 실행

각 서브에이전트는 **백그라운드**로 실행됩니다.

## 서브에이전트 트리거 순서

| 순서 | 트리거 조건 | 시작할 에이전트 | 컨텍스트 |
|-----|-----------|---------------|---------|
| 1 | 플랜 수립 완료 | API 에이전트 | `src/api/.ai.md` |
| 2 | API 타입 완성 | State 에이전트 | `src/state/.ai.md` + API 타입 |
| 2 | API 타입 완성 | Mock 에이전트 | `src/api/_mock/.ai.md` + API 타입 |
| 3 | State 타입 완성 | Page 에이전트 | `src/page/.ai.md` + State 타입 |

**핵심**: 다음 에이전트에게 **타입(껍데기)만** 넘기면 바로 시작 가능

## 마스터 에이전트에게 지시하는 방법

```
이 기능을 구현할 건데, 병렬 워크플로우로 진행해줘.

1. 먼저 요구사항 보고 API 구조랑 데이터 타입 플랜 짜줘
2. API 에이전트를 백그라운드로 시작해서 타입 껍데기 먼저 만들게 해
3. API 타입 완성되면:
   - State 에이전트 백그라운드로 시작 (src/state/.ai.md 참고)
   - Mock 에이전트 백그라운드로 시작 (빈 배열 → 샘플 데이터)
   - API 에이전트는 실제 구현 계속
4. State 타입 완성되면:
   - Page 에이전트 백그라운드로 시작 (src/page/.ai.md 참고)
   - State 에이전트는 실제 구현 계속

각 에이전트 결과 보고받고, 필요하면 피드백 전달해줘.
```

## 타입 전달 시점

각 에이전트가 "타입 완성"을 보고하면 다음 에이전트 트리거:

- **API 에이전트**: `types.ts` + `index.ts` 껍데기(함수 시그니처만) 완성 시
- **State 에이전트**: `types.ts` + 훅 시그니처 완성 시
- **Mock 에이전트**: 빈 배열로 타입만 잡아둔 시점 (이후 데이터 채움)

## 왜 이렇게 하는가

1. **기다리지 않는다**: 타입만 있으면 다음 레이어 즉시 시작
2. **컨텍스트 격리**: 각 에이전트는 자기 `.ai.md`만 보고 집중
3. **병렬 처리**: 여러 에이전트가 동시에 작업
4. **한큐에 완성**: 전달받은 타입이 명확하니까 헤매지 않음

## 주의사항

- 각 서브에이전트에게 해당 폴더의 `.ai.md`를 읽으라고 명시할 것
- 타입 변경 시 의존하는 에이전트에게 피드백 전달
- 마스터 에이전트가 전체 진행상황 모니터링
